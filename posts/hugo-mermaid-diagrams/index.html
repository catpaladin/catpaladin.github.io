<!doctype html><html lang=en-us><head><title>Getting Mermaid Diagrams Working in Hugo // Didactic Musings</title><link rel="shortcut icon" href=images/gopher_favicon.svg><meta charset=utf-8><meta name=generator content="Hugo 0.154.5"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Mike Sahari"><meta name=description content><meta property="og:site_name" content="Didactic Musings"><meta property="og:title" content="Getting Mermaid Diagrams Working in Hugo"><meta property="og:description" content="Let&rsquo;s be honest: adding Mermaid diagrams to your Hugo site should be straightforward, but it&rsquo;s often
a frustrating experience. Most tutorials gloss over the critical theme-specific modifications
required, leaving you with broken diagrams and cryptic errors.
After spending way too many hours banging my head against this particular wall with the m10c theme,
I&rsquo;m documenting the actual working solution so you don&rsquo;t have to suffer through the same pain.

  
    An Intro to Mermaid Through Examples
    #
  

If you&rsquo;re coming to this blog post and don&rsquo;t know what Mermaid diagrams are, they&rsquo;re a way to create
diagrams through code. Here are several visuals to give you an idea of what you can do with Mermaid."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.mikesahari.com/posts/hugo-mermaid-diagrams/"><link rel=stylesheet href=/dist/catpaladin-blog.css><script>localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),window.BLOG_DATA={siteTitle:"Didactic Musings",menu:[{Identifier:"blogs",Parent:"",Name:"Blogs",Pre:"",Post:"",URL:"/",PageRef:"",Weight:1,Title:"",Params:null,Menu:"main",ConfiguredURL:"/",Page:null,Children:null},{Identifier:"tags",Parent:"",Name:"Tags",Pre:"",Post:"",URL:"/tags/",PageRef:"",Weight:2,Title:"",Params:null,Menu:"main",ConfiguredURL:"/tags/",Page:null,Children:null},{Identifier:"about",Parent:"",Name:"About",Pre:"",Post:"",URL:"/about/",PageRef:"",Weight:3,Title:"",Params:null,Menu:"main",ConfiguredURL:"/about/",Page:null,Children:null},{Identifier:"rss",Parent:"",Name:"RSS",Pre:"",Post:"",URL:"/index.xml",PageRef:"",Weight:4,Title:"",Params:null,Menu:"main",ConfiguredURL:"/index.xml",Page:null,Children:null}],socials:[{icon:"brand-linkedin",name:"LinkedIn",url:"https://linkedin.com/in/mike-sahari"},{icon:"brand-github",name:"Github",url:"https://github.com/catpaladin"},{icon:"brand-mastodon",name:"Mastodon",url:"https://mastodon.social/@ineedmorecoffee"},{icon:"brand-bluesky",name:"Bluesky",url:"https://bsky.app/profile/msahari.bsky.social"}],description:"A tech blog for Go, Tech, and all the other things I find interesting.",author:"Mike Sahari",isPage:!0,section:"posts"}</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Getting Mermaid Diagrams Working in Hugo"><meta name=twitter:description content="Letâ€™s be honest: adding Mermaid diagrams to your Hugo site should be straightforward, but itâ€™s often a frustrating experience. Most tutorials gloss over the critical theme-specific modifications required, leaving you with broken diagrams and cryptic errors.
After spending way too many hours banging my head against this particular wall with the m10c theme, Iâ€™m documenting the actual working solution so you donâ€™t have to suffer through the same pain.
An Intro to Mermaid Through Examples # If youâ€™re coming to this blog post and donâ€™t know what Mermaid diagrams are, theyâ€™re a way to create diagrams through code. Here are several visuals to give you an idea of what you can do with Mermaid."><meta property="og:url" content="https://blog.mikesahari.com/posts/hugo-mermaid-diagrams/"><meta property="og:site_name" content="Didactic Musings"><meta property="og:title" content="Getting Mermaid Diagrams Working in Hugo"><meta property="og:description" content="Letâ€™s be honest: adding Mermaid diagrams to your Hugo site should be straightforward, but itâ€™s often a frustrating experience. Most tutorials gloss over the critical theme-specific modifications required, leaving you with broken diagrams and cryptic errors.
After spending way too many hours banging my head against this particular wall with the m10c theme, Iâ€™m documenting the actual working solution so you donâ€™t have to suffer through the same pain.
An Intro to Mermaid Through Examples # If youâ€™re coming to this blog post and donâ€™t know what Mermaid diagrams are, theyâ€™re a way to create diagrams through code. Here are several visuals to give you an idea of what you can do with Mermaid."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-01T19:48:53-08:00"><meta property="article:modified_time" content="2025-03-01T19:48:53-08:00"><meta property="article:tag" content="Hugo"><meta property="article:tag" content="Mermaid"><meta property="article:tag" content="Blogging"></head><body class="transition-colors duration-300"><div id=hugo-content style=display:none aria-hidden=true><div id=hugo-toc><nav id=TableOfContents><ul><li><a href=#an-intro-to-mermaid-through-examples>An Intro to Mermaid Through Examples</a><ul><li><a href=#sankey-diagrams>Sankey Diagrams</a></li><li><a href=#sequence-diagrams>Sequence Diagrams</a></li><li><a href=#class-diagrams>Class Diagrams</a></li><li><a href=#state-diagrams>State Diagrams</a></li><li><a href=#entity-relationship-diagrams>Entity Relationship Diagrams</a></li><li><a href=#gantt-chart-diagrams>Gantt Chart Diagrams</a></li></ul></li><li><a href=#the-problem-with-standard-hugo-mermaid-tutorials>The Problem with Standard Hugo Mermaid Tutorials</a></li><li><a href=#the-solution-theme-specific-implementation>The Solution: Theme-Specific Implementation</a><ul><li><a href=#step-1-create-the-base-template-override>Step 1: Create the Base Template Override</a></li><li><a href=#step-2-add-mermaid-support-to-the-base-template>Step 2: Add Mermaid Support to the Base Template</a></li><li><a href=#step-3-create-the-render-hook>Step 3: Create the Render Hook</a></li></ul></li><li><a href=#how-this-actually-works>How This Actually Works</a></li><li><a href=#using-mermaid-in-your-content>Using Mermaid in Your Content</a></li><li><a href=#why-your-theme-matters>Why Your Theme Matters</a></li><li><a href=#common-pitfalls-to-avoid>Common Pitfalls to Avoid</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><main class="max-w-4xl md:max-w-5xl lg:max-w-7xl mx-auto px-4 py-12"><article class="max-w-3xl mx-auto"><header class="flex flex-col mb-12"><time datetime=2025-03-01 class="order-first flex items-center text-base text-slate-400 dark:text-slate-500"><span class="h-4 w-0.5 rounded-full bg-slate-200 dark:bg-slate-500 mr-3"></span>
March 1, 2025
<span class=mx-2>Â·</span>
<span>7 min read</span></time><h1 class="mt-6 text-4xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-5xl">Getting Mermaid Diagrams Working in Hugo</h1><div class="mt-6 flex flex-wrap gap-2"><a href=/tags/hugo/ class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200 hover:bg-primary hover:text-white transition-colors">Hugo
</a><a href=/tags/mermaid/ class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200 hover:bg-primary hover:text-white transition-colors">Mermaid
</a><a href=/tags/blogging/ class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200 hover:bg-primary hover:text-white transition-colors">Blogging</a></div></header><div class="mb-12 rounded-2xl overflow-hidden shadow-xl"><img src=/images/gophers/go-fish.svg alt="Getting Mermaid Diagrams Working in Hugo" class="w-full h-auto object-cover"></div><div class="prose prose-slate dark:prose-invert max-w-none prose-a:text-primary hover:prose-a:text-primary-dark prose-pre:bg-slate-900 prose-pre:border prose-pre:border-slate-800"><p>Let&rsquo;s be honest: adding Mermaid diagrams to your Hugo site should be straightforward, but it&rsquo;s often
a frustrating experience. Most tutorials gloss over the critical theme-specific modifications
required, leaving you with broken diagrams and cryptic errors.</p><p>After spending way too many hours banging my head against this particular wall with the m10c theme,
I&rsquo;m documenting the actual working solution so you don&rsquo;t have to suffer through the same pain.</p><h2 id=an-intro-to-mermaid-through-examples><a href=#an-intro-to-mermaid-through-examples class="anchor-link group flex items-center no-underline hover:no-underline">An Intro to Mermaid Through Examples
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>If you&rsquo;re coming to this blog post and don&rsquo;t know what Mermaid diagrams are, they&rsquo;re a way to create
diagrams through code. Here are several visuals to give you an idea of what you can do with Mermaid.</p><h3 id=sankey-diagrams><a href=#sankey-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">Sankey Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid="c2Fua2V5LWJldGEKClRyYWZmaWMgU291cmNlcywgU29jaWFsIE1lZGlhLCAyMApUcmFmZmljIFNvdXJjZXMsIERpcmVjdCwgNDAKVHJhZmZpYyBTb3VyY2VzLCBTZWFyY2gsIDQwCgpTb2NpYWwgTWVkaWEsIEZhY2Vib29rLCA4ClNvY2lhbCBNZWRpYSwgVHdpdHRlciwgNwpTb2NpYWwgTWVkaWEsIExpbmtlZEluLCA1CgpEaXJlY3QsIEhvbWVwYWdlLCAyNQpEaXJlY3QsIEJsb2csIDE1CgpTZWFyY2gsIEhvbWVwYWdlLCAyMApTZWFyY2gsIEJsb2csIDE1ClNlYXJjaCwgUHJvZHVjdHMsIDU=">sankey-beta
Traffic Sources, Social Media, 20
Traffic Sources, Direct, 40
Traffic Sources, Search, 40
Social Media, Facebook, 8
Social Media, Twitter, 7
Social Media, LinkedIn, 5
Direct, Homepage, 25
Direct, Blog, 15
Search, Homepage, 20
Search, Blog, 15
Search, Products, 5</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>sankey-beta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Traffic Sources, Social Media, 20
</span></span><span style=display:flex><span>Traffic Sources, Direct, 40
</span></span><span style=display:flex><span>Traffic Sources, Search, 40
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Social Media, Facebook, 8
</span></span><span style=display:flex><span>Social Media, Twitter, 7
</span></span><span style=display:flex><span>Social Media, LinkedIn, 5
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Direct, Homepage, 25
</span></span><span style=display:flex><span>Direct, Blog, 15
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Search, Homepage, 20
</span></span><span style=display:flex><span>Search, Blog, 15
</span></span><span style=display:flex><span>Search, Products, 5
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><h3 id=sequence-diagrams><a href=#sequence-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">Sequence Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid="c2VxdWVuY2VEaWFncmFtCiAgICBwYXJ0aWNpcGFudCBDbGllbnQKICAgIHBhcnRpY2lwYW50IEFQSQogICAgcGFydGljaXBhbnQgREIKCiAgICBDbGllbnQtPj4rQVBJOiBHRVQgL3VzZXJzCiAgICBBUEktPj4rREI6IFNFTEVDVCAqIEZST00gdXNlcnMKICAgIERCLS0+Pi1BUEk6IFJldHVybiB1c2VyIGRhdGEKICAgIEFQSS0tPj4tQ2xpZW50OiAyMDAgT0sgKEpTT04pCgogICAgTm90ZSBvdmVyIENsaWVudCxBUEk6IE5vcm1hbCBmbG93CgogICAgQ2xpZW50LT4+K0FQSTogR0VUIC9pbnZhbGlkCiAgICBBUEktLT4+LUNsaWVudDogNDA0IE5vdCBGb3VuZA==">sequenceDiagram
participant Client
participant API
participant DB
Client->>+API: GET /users
API->>+DB: SELECT * FROM users
DB-->>-API: Return user data
API-->>-Client: 200 OK (JSON)
Note over Client,API: Normal flow
Client->>+API: GET /invalid
API-->>-Client: 404 Not Found</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>sequenceDiagram
</span></span><span style=display:flex><span>    participant Client
</span></span><span style=display:flex><span>    participant API
</span></span><span style=display:flex><span>    participant DB
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Client-&gt;&gt;+API: GET /users
</span></span><span style=display:flex><span>    API-&gt;&gt;+DB: SELECT * FROM users
</span></span><span style=display:flex><span>    DB--&gt;&gt;-API: Return user data
</span></span><span style=display:flex><span>    API--&gt;&gt;-Client: 200 OK (JSON)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Note over Client,API: Normal flow
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Client-&gt;&gt;+API: GET /invalid
</span></span><span style=display:flex><span>    API--&gt;&gt;-Client: 404 Not Found
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><h3 id=class-diagrams><a href=#class-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">Class Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid="Y2xhc3NEaWFncmFtCiAgICBjbGFzcyBBbmltYWwgewogICAgICAgICtTdHJpbmcgbmFtZQogICAgICAgICtpbnQgYWdlCiAgICAgICAgK21ha2VTb3VuZCgpCiAgICB9CiAgICBjbGFzcyBEb2cgewogICAgICAgICtTdHJpbmcgYnJlZWQKICAgICAgICArYmFyaygpCiAgICB9CiAgICBjbGFzcyBDYXQgewogICAgICAgICtib29sIGhhc05pbmVMaXZlcwogICAgICAgICttZW93KCkKICAgIH0KCiAgICBBbmltYWwgPHwtLSBEb2cKICAgIEFuaW1hbCA8fC0tIENhdA==">classDiagram
class Animal {
+String name
+int age
+makeSound()
}
class Dog {
+String breed
+bark()
}
class Cat {
+bool hasNineLives
+meow()
}
Animal &lt;|-- Dog
Animal &lt;|-- Cat</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>classDiagram
</span></span><span style=display:flex><span>    class Animal {
</span></span><span style=display:flex><span>        +String name
</span></span><span style=display:flex><span>        +int age
</span></span><span style=display:flex><span>        +makeSound()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    class Dog {
</span></span><span style=display:flex><span>        +String breed
</span></span><span style=display:flex><span>        +bark()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    class Cat {
</span></span><span style=display:flex><span>        +bool hasNineLives
</span></span><span style=display:flex><span>        +meow()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Animal &lt;|-- Dog
</span></span><span style=display:flex><span>    Animal &lt;|-- Cat
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><h3 id=state-diagrams><a href=#state-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">State Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid="c3RhdGVEaWFncmFtLXYyCiAgICBbKl0gLS0+IFBlbmRpbmcKICAgIFBlbmRpbmcgLS0+IFByb2Nlc3Npbmc6IFBheW1lbnQgcmVjZWl2ZWQKICAgIFByb2Nlc3NpbmcgLS0+IFNoaXBwZWQ6IEl0ZW0gaW4gc3RvY2sKICAgIFByb2Nlc3NpbmcgLS0+IEJhY2tvcmRlcmVkOiBPdXQgb2Ygc3RvY2sKICAgIEJhY2tvcmRlcmVkIC0tPiBTaGlwcGVkOiBSZXN0b2NrCiAgICBTaGlwcGVkIC0tPiBEZWxpdmVyZWQKICAgIFNoaXBwZWQgLS0+IFJldHVybmVkOiBDdXN0b21lciByZXR1cm5zCiAgICBEZWxpdmVyZWQgLS0+IFsqXQogICAgUmV0dXJuZWQgLS0+IFsqXQ==">stateDiagram-v2
[*] --> Pending
Pending --> Processing: Payment received
Processing --> Shipped: Item in stock
Processing --> Backordered: Out of stock
Backordered --> Shipped: Restock
Shipped --> Delivered
Shipped --> Returned: Customer returns
Delivered --> [*]
Returned --> [*]</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>stateDiagram-v2
</span></span><span style=display:flex><span>    [*] --&gt; Pending
</span></span><span style=display:flex><span>    Pending --&gt; Processing: Payment received
</span></span><span style=display:flex><span>    Processing --&gt; Shipped: Item in stock
</span></span><span style=display:flex><span>    Processing --&gt; Backordered: Out of stock
</span></span><span style=display:flex><span>    Backordered --&gt; Shipped: Restock
</span></span><span style=display:flex><span>    Shipped --&gt; Delivered
</span></span><span style=display:flex><span>    Shipped --&gt; Returned: Customer returns
</span></span><span style=display:flex><span>    Delivered --&gt; [*]
</span></span><span style=display:flex><span>    Returned --&gt; [*]
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><h3 id=entity-relationship-diagrams><a href=#entity-relationship-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">Entity Relationship Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid="ZXJEaWFncmFtCiAgICBVU0VSIHx8LS1veyBQT1NUIDogd3JpdGVzCiAgICBVU0VSIHsKICAgICAgICBpbnQgaWQKICAgICAgICBzdHJpbmcgZW1haWwKICAgICAgICBzdHJpbmcgbmFtZQogICAgfQogICAgUE9TVCB8fC0tb3sgQ09NTUVOVCA6IGhhcwogICAgUE9TVCB7CiAgICAgICAgaW50IGlkCiAgICAgICAgc3RyaW5nIHRpdGxlCiAgICAgICAgc3RyaW5nIGNvbnRlbnQKICAgICAgICBkYXRlIGNyZWF0ZWRfYXQKICAgIH0KICAgIENPTU1FTlQgewogICAgICAgIGludCBpZAogICAgICAgIHN0cmluZyBjb250ZW50CiAgICAgICAgaW50IHVzZXJfaWQKICAgIH0=">erDiagram
USER ||--o{ POST : writes
USER {
int id
string email
string name
}
POST ||--o{ COMMENT : has
POST {
int id
string title
string content
date created_at
}
COMMENT {
int id
string content
int user_id
}</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>erDiagram
</span></span><span style=display:flex><span>    USER ||--o{ POST : writes
</span></span><span style=display:flex><span>    USER {
</span></span><span style=display:flex><span>        int id
</span></span><span style=display:flex><span>        string email
</span></span><span style=display:flex><span>        string name
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    POST ||--o{ COMMENT : has
</span></span><span style=display:flex><span>    POST {
</span></span><span style=display:flex><span>        int id
</span></span><span style=display:flex><span>        string title
</span></span><span style=display:flex><span>        string content
</span></span><span style=display:flex><span>        date created_at
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    COMMENT {
</span></span><span style=display:flex><span>        int id
</span></span><span style=display:flex><span>        string content
</span></span><span style=display:flex><span>        int user_id
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><h3 id=gantt-chart-diagrams><a href=#gantt-chart-diagrams class="anchor-link group flex items-center no-underline hover:no-underline">Gantt Chart Diagrams
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><div class=mermaid data-mermaid=Z2FudHQKICAgIHRpdGxlIFByb2plY3QgVGltZWxpbmUKICAgIGRhdGVGb3JtYXQgIFlZWVktTU0tREQKICAgIHNlY3Rpb24gUGxhbm5pbmcKICAgIFJlcXVpcmVtZW50cyAgICA6YTEsIDIwMjQtMDEtMDEsIDMwZAogICAgRGVzaWduICAgICAgICAgOmFmdGVyIGExLCAyMGQKICAgIHNlY3Rpb24gRGV2ZWxvcG1lbnQKICAgIENvZGluZyAgICAgICAgIDoyMDI0LTAyLTE1LCA0NWQKICAgIFRlc3RpbmcgICAgICAgIDoyMDI0LTAzLTAxLCAzMGQKICAgIHNlY3Rpb24gTGF1bmNoCiAgICBEZXBsb3ltZW50ICAgICA6MjAyNC0wNC0wMSwgMTBk>gantt
title Project Timeline
dateFormat YYYY-MM-DD
section Planning
Requirements :a1, 2024-01-01, 30d
Design :after a1, 20d
section Development
Coding :2024-02-15, 45d
Testing :2024-03-01, 30d
section Launch
Deployment :2024-04-01, 10d</div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>gantt
</span></span><span style=display:flex><span>    title Project Timeline
</span></span><span style=display:flex><span>    dateFormat  YYYY-MM-DD
</span></span><span style=display:flex><span>    section Planning
</span></span><span style=display:flex><span>    Requirements    :a1, 2024-01-01, 30d
</span></span><span style=display:flex><span>    Design         :after a1, 20d
</span></span><span style=display:flex><span>    section Development
</span></span><span style=display:flex><span>    Coding         :2024-02-15, 45d
</span></span><span style=display:flex><span>    Testing        :2024-03-01, 30d
</span></span><span style=display:flex><span>    section Launch
</span></span><span style=display:flex><span>    Deployment     :2024-04-01, 10d
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><p>Nice, huh? Diagrams make it easier for some readers to understand concepts. Through the work in this
blog, I was able to implement the same Mermaid codeblocks as in my Obsidian notes.</p><h2 id=the-problem-with-standard-hugo-mermaid-tutorials><a href=#the-problem-with-standard-hugo-mermaid-tutorials class="anchor-link group flex items-center no-underline hover:no-underline">The Problem with Standard Hugo Mermaid Tutorials
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>The <a href=https://gohugo.io/content-management/diagrams/#mermaid-diagrams>official Hugo documentation</a>
provides a basic implementation that works great&mldr; if you&rsquo;re using the default theme with no
customizations. But let&rsquo;s be real - who does that?</p><p>Most of us are using custom themes (like m10c in my case), and that&rsquo;s where things break down. The
standard implementation doesn&rsquo;t account for how themes structure their templates and load
JavaScript.</p><div class="my-8 rounded-2xl border-l-4 overflow-hidden shadow-lg border-primary bg-white dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 transition-all"><div class="px-6 py-3 font-bold text-white bg-primary">ðŸ’¡ TIP</div><div class="p-6 text-slate-700 dark:text-slate-200 leading-relaxed prose-sm dark:prose-invert">The key insight: You need to override your
theme&rsquo;s base template, not just add the render hook.</div></div><h2 id=the-solution-theme-specific-implementation><a href=#the-solution-theme-specific-implementation class="anchor-link group flex items-center no-underline hover:no-underline">The Solution: Theme-Specific Implementation
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>Here&rsquo;s my working implementation for the m10c theme, with explanations of why each part matters:</p><h3 id=step-1-create-the-base-template-override><a href=#step-1-create-the-base-template-override class="anchor-link group flex items-center no-underline hover:no-underline">Step 1: Create the Base Template Override
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><p>First, you need to override your theme&rsquo;s base template. For m10c, that means:</p><ol><li>Identify the original template: <code>themes/m10c/layouts/_default/baseof.html</code></li><li>Create your override at: <code>layouts/_default/baseof.html</code></li><li>Copy the content from the theme&rsquo;s template to your override</li></ol><h3 id=step-2-add-mermaid-support-to-the-base-template><a href=#step-2-add-mermaid-support-to-the-base-template class="anchor-link group flex items-center no-underline hover:no-underline">Step 2: Add Mermaid Support to the Base Template
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><p>Next, modify your override to include the Mermaid library. Add this code just before the closing
<code>&lt;/body></code> tag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- Add Mermaid support - must be placed before closing body tag --&gt;</span>
</span></span><span style=display:flex><span>{{ if .Store.Get &#34;hasMermaid&#34; }}
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;module&#34;</span>&gt;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>import</span> <span style=color:#a6e22e>mermaid</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mermaid</span>.<span style=color:#a6e22e>initialize</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>startOnLoad</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dark&#39;</span>, <span style=color:#75715e>// Options: default, forest, dark, neutral
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityLevel</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;loose&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Add custom theme properties
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>themeVariables</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Primary colors
</span></span></span><span style=display:flex><span>      <span style=color:#a6e22e>primaryColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#BB2528&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>primaryTextColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#fff&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>primaryBorderColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#7C0000&#39;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Secondary colors
</span></span></span><span style=display:flex><span>      <span style=color:#a6e22e>secondaryColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#006100&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>secondaryTextColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#fff&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>secondaryBorderColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#004d00&#39;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Other colors as needed
</span></span></span><span style=display:flex><span>      <span style=color:#a6e22e>mainBkg</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#1f2020&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>textColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ddd&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>lineColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#999&#39;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Specific diagram colors
</span></span></span><span style=display:flex><span>      <span style=color:#a6e22e>nodeBorder</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#777&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>titleColor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#F8F8F8&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>{{ end }}
</span></span></code></pre></div><p>This code checks if the page has Mermaid content (using Hugo&rsquo;s Store) and only loads the Mermaid
library when needed. The custom theme variables ensure your diagrams match your site&rsquo;s dark theme.</p><h3 id=step-3-create-the-render-hook><a href=#step-3-create-the-render-hook class="anchor-link group flex items-center no-underline hover:no-underline">Step 3: Create the Render Hook
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h3><p>Now create a file at <code>layouts/_default/_markup/render-codeblock-mermaid.html</code> with the following
content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>pre</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mermaid&#34;</span>&gt;
</span></span><span style=display:flex><span>  {{- .Inner | htmlEscape | safeHTML }}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>pre</span>&gt;
</span></span><span style=display:flex><span>{{ .Page.Store.Set &#34;hasMermaid&#34; true }}
</span></span></code></pre></div><p>This render hook does two critical things:</p><ol><li>Wraps your Mermaid code in the correct HTML structure</li><li>Sets a flag in the page&rsquo;s Store so the base template knows to load the Mermaid library</li></ol><h2 id=how-this-actually-works><a href=#how-this-actually-works class="anchor-link group flex items-center no-underline hover:no-underline">How This Actually Works
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>Let me explain the process flow with a Mermaid diagram:</p><div class=mermaid data-mermaid=Zmxvd2NoYXJ0IFRECiAgICBBW1dyaXRlIE1hcmtkb3duIHdpdGggTWVybWFpZCBDb2RlXSAtLT4gQltIdWdvIFByb2Nlc3NlcyBNYXJrZG93bl0KICAgIEIgLS0+IENbUmVuZGVyIEhvb2sgUHJvY2Vzc2VzIE1lcm1haWQgQmxvY2tzXQogICAgQyAtLT4gRFtTZXRzIGhhc01lcm1haWQgRmxhZyBpbiBQYWdlIFN0b3JlXQogICAgRCAtLT4gRVtCYXNlIFRlbXBsYXRlIENoZWNrcyBmb3IgaGFzTWVybWFpZCBGbGFnXQogICAgRSAtLT4gRltNZXJtYWlkIExpYnJhcnkgTG9hZHMgaWYgRmxhZyBpcyBUcnVlXQogICAgRiAtLT4gR1tNZXJtYWlkIExpYnJhcnkgUmVuZGVycyBEaWFncmFtc10KCiAgICBzdHlsZSBBIGZpbGw6IzIyMixzdHJva2U6I0JCMjUyOCxjb2xvcjojZGRkCiAgICBzdHlsZSBHIGZpbGw6IzAwNjEwMCxzdHJva2U6IzAwNGQwMCxjb2xvcjojZGRk>flowchart TD
A[Write Markdown with Mermaid Code] --> B[Hugo Processes Markdown]
B --> C[Render Hook Processes Mermaid Blocks]
C --> D[Sets hasMermaid Flag in Page Store]
D --> E[Base Template Checks for hasMermaid Flag]
E --> F[Mermaid Library Loads if Flag is True]
F --> G[Mermaid Library Renders Diagrams]
style A fill:#222,stroke:#BB2528,color:#ddd
style G fill:#006100,stroke:#004d00,color:#ddd</div><p>The key insight here is that the render hook and base template work together through Hugo&rsquo;s Store
mechanism. Without either piece, the system breaks down.</p><h2 id=using-mermaid-in-your-content><a href=#using-mermaid-in-your-content class="anchor-link group flex items-center no-underline hover:no-underline">Using Mermaid in Your Content
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>With this implementation in place, you can now add Mermaid diagrams to your Markdown content like
this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#e6db74>```mermaid
</span></span></span><span style=display:flex><span>flowchart LR
</span></span><span style=display:flex><span>    A[Start] --&gt; B{Decision}
</span></span><span style=display:flex><span>    B --&gt;|Yes| C[Action 1]
</span></span><span style=display:flex><span>    B --&gt;|No| D[Action 2]
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><div class="my-8 rounded-2xl border-l-4 overflow-hidden shadow-lg border-primary bg-white dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 transition-all"><div class="px-6 py-3 font-bold text-white bg-primary">ðŸ’¡ TIP</div><div class="p-6 text-slate-700 dark:text-slate-200 leading-relaxed prose-sm dark:prose-invert">Always use the explicit <code>mermaid</code> language
identifier for your code blocks, not just triple backticks.</div></div><h2 id=why-your-theme-matters><a href=#why-your-theme-matters class="anchor-link group flex items-center no-underline hover:no-underline">Why Your Theme Matters
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>Different Hugo themes structure their templates differently. The approach I&rsquo;ve outlined works for
m10c, but you might need to adjust it for other themes. The general principles remain the same:</p><ol><li>Override the base template that controls your HTML output</li><li>Add conditional loading of the Mermaid library based on content</li><li>Create a render hook that flags pages containing Mermaid code</li></ol><h2 id=common-pitfalls-to-avoid><a href=#common-pitfalls-to-avoid class="anchor-link group flex items-center no-underline hover:no-underline">Common Pitfalls to Avoid
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>Here are some issues I encountered that aren&rsquo;t mentioned in most tutorials:</p><ol><li><strong>Missing the theme override</strong>: Just adding the render hook isn&rsquo;t enough</li><li><strong>Incorrect script loading</strong>: Modern Mermaid uses ES modules, requiring the type=&ldquo;module&rdquo;
attribute</li><li><strong>Theme incompatibility</strong>: Dark-themed sites need custom Mermaid styling</li><li><strong>Resource loading order</strong>: The Mermaid library must load after your content is ready</li></ol><h2 id=conclusion><a href=#conclusion class="anchor-link group flex items-center no-underline hover:no-underline">Conclusion
<span class="ml-2 opacity-0 group-hover:opacity-100 transition-opacity text-primary">#</span></a></h2><p>Getting Mermaid diagrams working in Hugo requires understanding how your specific theme handles
templates and JavaScript. The solution I&rsquo;ve outlined for m10c addresses these theme-specific
concerns and provides a robust implementation that works reliably.</p><p>By overriding the appropriate templates and leveraging Hugo&rsquo;s Store mechanism, you can seamlessly
integrate Mermaid diagrams into your content without fighting with your theme.</p></div><footer class="mt-16 pt-8 border-t border-slate-200 dark:border-slate-800"></footer></article></main></div><div id=app></div><script src=/dist/app.js defer></script><script data-goatcounter=https://msahari-blog.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>